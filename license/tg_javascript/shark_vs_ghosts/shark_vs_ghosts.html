<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shark vs Ghosts</title>
  <style>
    :root{--bg:#070717;--panel:#0f1724;--accent:#00e6ff}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#001);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    .wrap{height:100%;display:flex;align-items:center;justify-content:center;gap:20px;padding:30px}
    .game-card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.06));padding:14px;border-radius:14px;box-shadow:0 8px 30px rgba(0,0,0,0.6);display:grid;grid-template-columns:1fr;align-items:start}
    header{display:flex;align-items:center;gap:12px;color:white;margin-bottom:8px}
    h1{font-size:20px;margin:0}
    .controls{color:#9aa7c7;font-size:13px}
    canvas{background:linear-gradient(180deg,#02112a, #001018);display:block;border-radius:8px}
    .hud{color:#dff;display:flex;justify-content:space-between;padding:6px 10px;font-family:monospace;font-size:14px}
    .instructions{color:#9aa7c7;font-size:13px;margin-top:8px}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#9fb6ff;padding:6px 10px;border-radius:8px;cursor:pointer}
    .overlay{position:absolute;left:50%;transform:translateX(-50%);top:54px;color:#fff;padding:8px 12px;border-radius:8px;background:rgba(0,0,0,0.35);font-family:monospace}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="game-card">
      <header>
        <div>
          <h1>ðŸ¦ˆ Shark vs Ghosts</h1>
          <div class="controls">Move: arrow keys / WASD â€¢ Shoot: Space</div>
        </div>
        <div style="margin-left:12px">
          <button class="btn" id="restart">Restart</button>
        </div>
      </header>

      <div style="position:relative">
        <div class="hud">
          <div id="score">Score: 0</div>
          <div id="health">Health: 5</div>
          <div id="level">Level: 1</div>
        </div>
        <canvas id="game" width="900" height="560"></canvas>
      </div>

      <div class="instructions">Ghosts spawn from the top and drift toward your shark. Shoot them with lasers (spacebar). Survive and rack up points!</div>
    </div>
  </div>

<script>
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const W = canvas.width; const H = canvas.height;

  // Game state
  let keys = {};
  let lasers = [];
  let ghosts = [];
  let explosions = [];
  let score = 0;
  let health = 5;
  let level = 1;
  let spawnTimer = 0;
  let spawnInterval = 90; // frames
  let frame = 0;
  let playing = true;

  // Shark player
  const player = {
    x: W/2,
    y: H - 100,
    r: 28,
    speed: 5,
    emoji: 'ðŸ¦ˆ',
    shootCooldown: 0,
    shootDelay: 10,
  };

  // Helpers
  function rand(min,max){return Math.random()*(max-min)+min}
  function clamp(v,a,b){return Math.max(a,Math.min(b,v))}
  function dist(a,b){const dx=a.x-b.x, dy=a.y-b.y; return Math.sqrt(dx*dx+dy*dy)}

  // Input
  window.addEventListener('keydown', e => {keys[e.code]=true; if (e.code==='Space') e.preventDefault();});
  window.addEventListener('keyup', e => {keys[e.code]=false;});

  document.getElementById('restart').addEventListener('click', reset);

  // Spawn ghosts
  function spawnGhost(){
    const r = rand(18,34);
    const x = rand(r, W-r);
    const y = -r - rand(10,80);
    // velocity toward bottom and a slow homing toward player
    ghosts.push({x,y,r,angle:rand(0,Math.PI*2),speed:rand(0.6,1.6),hp:1+Math.floor(level/3), wobble: rand(0.01,0.06) });
  }

  // Shoot
  function shoot(){
    if (player.shootCooldown>0) return;
    player.shootCooldown = player.shootDelay;
    lasers.push({x: player.x + 30, y: player.y-8, vx: 11, vy: 0, life: 90});
    lasers.push({x: player.x - 30, y: player.y-8, vx: 11, vy: 0, life: 90, flip:true});
    // small sound
    try{
      const o = new (window.AudioContext||window.webkitAudioContext)();
      const s = o.createOscillator();
      const g = o.createGain();
      s.type='sine'; s.frequency.value = 900; g.gain.value = 0.02; s.connect(g); g.connect(o.destination); s.start(); s.stop(o.currentTime+0.05);
    }catch(e){}
  }

  // Explosions
  function makeExplosion(x,y, n=14){
    for(let i=0;i<n;i++){
      explosions.push({x,y,vx:Math.cos(i/n*2*Math.PI)*rand(1.6,4.5), vy:Math.sin(i/n*2*Math.PI)*rand(1.6,4.5), life:40});
    }
  }

  // Update
  function update(){
    if(!playing) return;
    frame++;
    // movement
    if (keys['ArrowLeft']||keys['KeyA']) player.x -= player.speed;
    if (keys['ArrowRight']||keys['KeyD']) player.x += player.speed;
    if (keys['ArrowUp']||keys['KeyW']) player.y -= player.speed;
    if (keys['ArrowDown']||keys['KeyS']) player.y += player.speed;
    player.x = clamp(player.x, 20, W-20);
    player.y = clamp(player.y, 60, H-20);

    // shooting
    if ((keys['Space'] || keys['KeyX']) && player.shootCooldown<=0) shoot();
    if (player.shootCooldown>0) player.shootCooldown--;

    // lasers
    for(let i=lasers.length-1;i>=0;i--){
      const L = lasers[i];
      L.x += (L.flip? -1:1) * L.vx;
      L.y += L.vy;
      L.life--;
      if (L.life<=0 || L.x< -50 || L.x> W+50) lasers.splice(i,1);
    }

    // ghosts
    spawnTimer++;
    const dynamicInterval = Math.max(18, spawnInterval - Math.floor(level*4));
    if (spawnTimer > dynamicInterval){ spawnTimer = 0; spawnGhost(); }

    for(let i=ghosts.length-1;i>=0;i--){
      const g = ghosts[i];
      // simple homing toward player
      const angle = Math.atan2(player.y - g.y, player.x - g.x);
      g.x += Math.cos(angle) * g.speed + Math.sin(frame*g.wobble)*0.8;
      g.y += Math.sin(angle) * g.speed + 0.3;
      // collision with player
      const d = Math.hypot(g.x - player.x, g.y - player.y);
      if (d < g.r + player.r - 6){
        // hit
        ghosts.splice(i,1);
        makeExplosion(player.x, player.y, 20);
        health -= 1;
        if (health<=0){ gameOver(); }
        continue;
      }
      // hit by lasers
      for(let j=lasers.length-1;j>=0;j--){
        const L = lasers[j];
        const dl = Math.hypot(g.x - L.x, g.y - L.y);
        if (dl < g.r + 6){
          g.hp -= 1; lasers.splice(j,1);
          if (g.hp<=0){
            score += 10;
            makeExplosion(g.x,g.y, 12);
            ghosts.splice(i,1);
          }
          break;
        }
      }
    }

    // explosions
    for(let i=explosions.length-1;i>=0;i--){
      const p = explosions[i];
      p.x += p.vx; p.y += p.vy; p.vy *= 0.98; p.vx *= 0.99; p.life--;
      if (p.life<=0) explosions.splice(i,1);
    }

    // level progression
    if (score > level * 120){ level++; }

    // hud
    document.getElementById('score').textContent = 'Score: ' + score;
    document.getElementById('health').textContent = 'Health: ' + health;
    document.getElementById('level').textContent = 'Level: ' + level;
  }

  // Render
  function render(){
    // background
    ctx.clearRect(0,0,W,H);

    // subtle grid/wave
    ctx.save();
    ctx.globalAlpha = 0.06;
    for(let x=0;x<W;x+=28){
      ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,H); ctx.strokeStyle='#00f'; ctx.stroke();
    }
    ctx.restore();

    // lasers
    for(const L of lasers){
      ctx.save();
      ctx.fillStyle = '#00f0ff';
      ctx.strokeStyle = '#9ff';
      ctx.beginPath();
      ctx.rect(L.x-6, L.y-3, 12, 6);
      ctx.fill(); ctx.stroke();
      ctx.restore();
    }

    // ghosts
    for(const g of ghosts){
      ctx.save();
      ctx.font = (g.r*2) + 'px serif';
      ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
      // ghost emoji
      ctx.fillText('ðŸ‘»', g.x, g.y+2);
      // faint shadow circle
      ctx.beginPath(); ctx.arc(g.x,g.y,g.r+2,0,Math.PI*2); ctx.strokeStyle='rgba(255,255,255,0.04)'; ctx.stroke();
      ctx.restore();
    }

    // player
    ctx.save();
    ctx.font = (player.r*3) + 'px serif';
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.fillText(player.emoji, player.x, player.y);
    // thruster glow
    ctx.beginPath(); ctx.ellipse(player.x, player.y+36, 38, 12, 0, 0, Math.PI*2);
    ctx.fillStyle = 'rgba(0,200,255,0.06)'; ctx.fill();
    ctx.restore();

    // explosions
    for(const p of explosions){
      ctx.beginPath(); ctx.arc(p.x,p.y, Math.max(1, p.life/6),0,Math.PI*2);
      ctx.fillStyle = 'rgba(255,220,120,' + (p.life/40) + ')'; ctx.fill();
    }

    // overlay text when not playing
    if(!playing){
      ctx.save(); ctx.fillStyle='rgba(0,0,0,0.6)'; ctx.fillRect(0,0,W,H);
      ctx.fillStyle = '#fff'; ctx.font='34px system-ui'; ctx.textAlign='center'; ctx.fillText('GAME OVER', W/2, H/2 - 20);
      ctx.font='18px system-ui'; ctx.fillText('Press Restart to play again', W/2, H/2 + 18);
      ctx.restore();
    }
  }

  function loop(){ update(); render(); requestAnimationFrame(loop); }

  function gameOver(){ playing = false; }

  function reset(){
    keys = {}; lasers = []; ghosts = []; explosions = []; score = 0; health = 5; level = 1; spawnTimer=0; playing = true; player.x = W/2; player.y = H-100; player.shootCooldown=0;
  }

  // start with a few ghosts
  for(let i=0;i<2;i++) spawnGhost();
  loop();

})();
</script>
</body>
</html>
