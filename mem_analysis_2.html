<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Emoji Card Studio — Mobile Friendly</title>
<style>
  body{margin:0;font-family:sans-serif;background:#1a1a1a;color:#f0f0f0;display:flex;flex-direction:column;align-items:center;padding:10px}
  h1{text-align:center;font-size:1.6em;margin:0 0 10px}
  .emoji-strip{display:flex;overflow-x:auto;padding:6px;background:#222;border-radius:8px;margin-bottom:10px}
  .emoji-strip span{font-size:32px;margin:0 6px;cursor:pointer;user-select:none}
  .card-container{position:relative;width:90vw;max-width:400px;height:400px;background:#333;border-radius:12px;overflow:hidden;touch-action:none}
  .layer{position:absolute;cursor:grab;user-select:none}
  .layer img, .layer span{text-align:center;display:block}
  .controls{margin-top:12px;display:flex;flex-wrap:wrap;gap:6px;justify-content:center}
  .btn{padding:6px 12px;background:#7dd3fc;color:#012;border:none;border-radius:8px;cursor:pointer;font-weight:600}
  input[type=range]{width:100px}
  footer{margin-top:10px;font-size:12px;color:#aaa;text-align:center;}
</style>
</head>
<body>
<h1>Emoji Card Studio</h1>
<div class="emoji-strip" id="emojiStrip"></div>
<div class="card-container" id="cardContainer"></div>
<div class="controls">
  <button class="btn" id="addText">Add Text</button>
  <button class="btn" id="exportPNG">Save PNG</button>
  <button class="btn" id="exportGIF">Export GIF (warning: CPU heavy)</button>
</div>
<footer>Standalone & mobile-friendly. Drag emojis onto the card. GIF export works locally.</footer>
<script src="https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.js"></script>
<script>
const emojis=["😀","😂","😍","😎","🥳","🤯","🤔","😜","😇","🙃","😡","😭","😱","🤗","😏","🤩","😋","🤪","😴","👻"];
const emojiStrip=document.getElementById('emojiStrip');
const cardContainer=document.getElementById('cardContainer');
const layers=[];

emojis.forEach(e=>{
  const span=document.createElement('span');
  span.textContent=e;
  span.addEventListener('click',()=>addLayer(e));
  emojiStrip.appendChild(span);
});

function addLayer(content){
  const div=document.createElement('div');
  div.className='layer';
  div.style.left='40%';
  div.style.top='40%';
  div.style.fontSize='40px';
  div.textContent=content;
  makeDraggable(div);
  cardContainer.appendChild(div);
  layers.push(div);
}

function makeDraggable(el){
  let offsetX=0,offsetY=0,dragging=false;
  el.addEventListener('pointerdown',e=>{
    dragging=true;
    offsetX=e.clientX-el.offsetLeft;
    offsetY=e.clientY-el.offsetTop;
    el.setPointerCapture(e.pointerId);
  });
  el.addEventListener('pointermove',e=>{
    if(dragging){
      let x=e.clientX-offsetX;
      let y=e.clientY-offsetY;
      x=Math.max(0,Math.min(cardContainer.clientWidth-el.offsetWidth,x));
      y=Math.max(0,Math.min(cardContainer.clientHeight-el.offsetHeight,y));
      el.style.left=x+'px';
      el.style.top=y+'px';
    }
  });
  el.addEventListener('pointerup',e=>{dragging=false;});
}

document.getElementById('addText').addEventListener('click',()=>{
  const text=prompt('Enter text:','Hello!');
  if(text)addLayer(text);
});

function exportPNG(){
  const canvas=document.createElement('canvas');
  canvas.width=cardContainer.clientWidth;
  canvas.height=cardContainer.clientHeight;
  const ctx=canvas.getContext('2d');
  ctx.fillStyle='#333';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  layers.forEach(l=>{
    ctx.font=l.style.fontSize+'px sans-serif';
    ctx.fillStyle='#fff';
    ctx.fillText(l.textContent,l.offsetLeft,l.offsetTop+parseInt(l.style.fontSize));
  });
  const link=document.createElement('a');
  link.download='card.png';
  link.href=canvas.toDataURL();
  link.click();
}

document.getElementById('exportPNG').addEventListener('click',exportPNG);

document.getElementById('exportGIF').addEventListener('click',()=>{
  const gif=new GIF({workers:2,quality:10,width:cardContainer.clientWidth,height:cardContainer.clientHeight});
  for(let f=0;f<10;f++){
    const canvas=document.createElement('canvas');
    canvas.width=cardContainer.clientWidth;
    canvas.height=cardContainer.clientHeight;
    const ctx=canvas.getContext('2d');
    ctx.fillStyle='#333';ctx.fillRect(0,0,canvas.width,canvas.height);
    layers.forEach(l=>{
      ctx.font=l.style.fontSize+'px sans-serif';
      ctx.fillStyle='#fff';
      const x=l.offsetLeft+Math.sin(f/10*Math.PI*2)*5;
      const y=l.offsetTop+parseInt(l.style.fontSize)+Math.cos(f/10*Math.PI*2)*5;
      ctx.fillText(l.textContent,x,y);
    });
    gif.addFrame(ctx,{delay:100});
  }
  gif.on('finished',function(blob){
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;a.download='card.gif';a.click();
    URL.revokeObjectURL(url);
  });
  gif.render();
});
</script>
</body>
</html>
