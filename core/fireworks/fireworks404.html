<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Snappy Animal Fireworks</title>
<style>
  html,body {margin:0;height:100%;background:#111;overflow:hidden;}
  canvas {display:block;width:100%;height:100%;cursor:crosshair;}
</style>
</head>
<body>
<canvas id="c"></canvas>
<script>
(() => {
  const canvas = document.getElementById("c");
  const ctx = canvas.getContext("2d");
  function resize() {
    canvas.width = innerWidth;
    canvas.height = innerHeight;
  }
  addEventListener("resize", resize);
  resize();

  const parts = [];
  const rand = (a,b)=>a+Math.random()*(b-a);
  const now = ()=>performance.now();

  // --- Animal templates ---
  const animals = {
    butterfly: [[-20,0],[20,0],[-40,-20],[40,-20],[-30,20],[30,20]],
    fish: [[-30,0],[-10,-10],[10,0],[-10,10]],
    bird: [[-20,-10],[0,10],[20,-10]],
    rabbit: [[-10,0],[10,0],[0,-20],[0,-40]],
    turtle: [[-15,0],[15,0],[0,-15],[0,15]]
  };
  const animalKeys = Object.keys(animals);

  function spawnAnimal(x,y){
    const shape = animals[animalKeys[Math.floor(Math.random()*animalKeys.length)]];
    const hue = Math.floor(Math.random()*360);
    const life = 700; // short, snappy animal phase
    shape.forEach(([ox,oy])=>{
      parts.push({
        type:"animal",
        x:x+ox, y:y+oy,
        hue,
        created: now(),
        life,
        size: rand(8,14) // larger animal dots
      });
    });
    // schedule burst
    setTimeout(()=>spawnBurst(x,y,hue), life);
  }

  function spawnBurst(x,y,hue){
    const count = Math.floor(rand(60,100));
    for(let i=0;i<count;i++){
      const angle = rand(0,Math.PI*2);
      const speed = rand(0.3,1.0); // keep quick burst
      parts.push({
        type:"burst",
        x,y,
        angle,
        speed,
        size: rand(4,8), // larger burst particles
        hue,
        created: now(),
        life: 2000,
        trail:[]
      });
    }
  }

  function spawnSwirl(x,y){
    const hue = Math.floor(Math.random()*360);
    const life = 8000;
    const count = Math.floor(rand(15,30));
    const spin = rand(-2,2);
    for(let i=0;i<count;i++){
      parts.push({
        type:"swirl",
        x,y,
        angle:(i/count)*Math.PI*2,
        radius:rand(20,60),
        speed:rand(0.1,0.3),
        spin,
        size: rand(6,12), // bigger swirls
        hue,
        created:now(),
        life,
        phase:rand(0,Math.PI*2),
        trail:[]
      });
    }
  }

  function handleClick(e){
    const x=e.clientX, y=e.clientY;
    Math.random()<0.5 ? spawnSwirl(x,y) : spawnAnimal(x,y);
  }
  canvas.addEventListener("click",handleClick);

  function draw(){
    ctx.fillStyle="rgba(17,17,17,0.3)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.globalCompositeOperation="lighter";

    const t=now();
    for(let i=parts.length-1;i>=0;i--){
      const p=parts[i];
      const elapsed=t-p.created;
      if(elapsed>p.life){parts.splice(i,1);continue;}
      const alpha=1-elapsed/p.life;
      ctx.shadowBlur=20;
      ctx.shadowColor=`hsla(${p.hue},100%,70%,${alpha})`;

      if(p.type==="animal"){
        ctx.fillStyle=`hsla(${p.hue},90%,60%,${alpha})`;
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
        ctx.fill();
      }
      else if(p.type==="burst"){
        const dist=p.speed*elapsed*2.2; // faster expansion
        const nx=p.x+Math.cos(p.angle)*dist;
        const ny=p.y+Math.sin(p.angle)*dist;
        p.trail.push({x:nx,y:ny});
        if(p.trail.length>5) p.trail.shift();
        ctx.strokeStyle=`hsla(${p.hue},100%,70%,${alpha*0.8})`;
        ctx.lineWidth=p.size*0.7;
        ctx.beginPath();
        ctx.moveTo(p.trail[0].x,p.trail[0].y);
        for(let j=1;j<p.trail.length;j++){
          ctx.lineTo(p.trail[j].x,p.trail[j].y);
        }
        ctx.stroke();

        ctx.fillStyle=`hsla(${p.hue},100%,60%,${alpha})`;
        ctx.beginPath();
        ctx.arc(nx,ny,p.size*1.2,0,Math.PI*2);
        ctx.fill();
      }
      else if(p.type==="swirl"){
        p.angle+=p.spin*0.001*16;
        p.radius+=p.speed*2;
        const nx=p.x+Math.cos(p.angle)*p.radius;
        const ny=p.y+Math.sin(p.angle)*p.radius;
        p.trail.push({x:nx,y:ny});
        if(p.trail.length>6) p.trail.shift();
        ctx.strokeStyle=`hsla(${p.hue},100%,70%,${alpha*0.8})`;
        ctx.lineWidth=p.size*0.6;
        ctx.beginPath();
        ctx.moveTo(p.trail[0].x,p.trail[0].y);
        for(let j=1;j<p.trail.length;j++){
          ctx.lineTo(p.trail[j].x,p.trail[j].y);
        }
        ctx.stroke();
      }
    }
    ctx.globalCompositeOperation="source-over";
    requestAnimationFrame(draw);
  }
  draw();
})();
</script>
</body>
</html>
