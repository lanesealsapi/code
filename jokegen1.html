<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Logic-Based Joke Generator</title>
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#ffcc00;--muted:#9aa4b2}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial}
    body{display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#071026,#071026 40%, #041025);color:#e6eef8;padding:28px}
    .card{width:100%;max-width:720px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:24px;box-shadow:0 10px 40px rgba(2,6,23,0.6)}
    h1{margin:0 0 8px;color:var(--accent);font-size:20px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:14px}
    .btn{background:var(--accent);color:#081028;border:0;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer}
    .btn:active{transform:translateY(1px)}
    .small{font-size:13px;color:var(--muted)}
    .joke{margin-top:8px;padding:16px;border-radius:10px;background:rgba(255,255,255,0.02);font-size:18px;line-height:1.4;min-height:64px;display:flex;align-items:center;justify-content:center;text-align:center}
    .meta{margin-top:12px;font-size:13px;color:var(--muted);display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .seed{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:6px 8px;border-radius:8px}
    .toggle{display:inline-flex;align-items:center;gap:8px}
    input[type="range"]{width:160px}
    footer{margin-top:16px;font-size:12px;color:var(--muted);text-align:center}
  </style>
</head>
<body>
  <main class="card" role="main">
    <h1>Logic-Based Joke Generator</h1>
    <p class="lead">Not random nonsense — jokes are built with simple rules and a pinch of misdirection.</p>

    <div class="controls">
      <button id="gen" class="btn">Generate Joke</button>
      <button id="metaBtn" class="btn" style="background:#2b3340;color:var(--accent)">Explain Logic</button>

      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <label class="small">Silliness</label>
        <input id="sill" type="range" min="0" max="10" value="6" />
        <label class="small">Length</label>
        <input id="length" type="range" min="1" max="5" value="3" />
      </div>
    </div>

    <div id="joke" class="joke">Press "Generate Joke" and prepare to giggle (or groan).</div>

    <div class="meta">
      <div class="small">Seed: <span id="seed" class="seed">—</span></div>
      <div class="small">Type: <span id="jtype" class="seed">—</span></div>
      <div class="small">Mood: <span id="jmood" class="seed">—</span></div>
    </div>

    <div id="explain" style="display:none;margin-top:12px;padding:12px;border-radius:8px;background:rgba(255,255,255,0.015);font-size:13px;color:var(--muted)"></div>

    <footer>Pure client-side logic — no external libraries.</footer>
  </main>

  <script>
    // Utilities
    function randInt(rng, a, b){ return Math.floor(rng() * (b - a + 1)) + a; }
    function pick(rng, arr){ return arr[Math.floor(rng() * arr.length)]; }
    function seededRng(seed){
      // simple xorshift-ish generator from seed string -> number
      let h = 2166136261 >>> 0;
      for (let i=0;i<seed.length;i++){ h = Math.imul(h ^ seed.charCodeAt(i), 16777619) >>> 0; }
      return function(){ h ^= h << 13; h ^= h >>> 17; h ^= h << 5; return ((h >>> 0) / 4294967295); };
    }

    // Data building blocks
    const SUBJECTS = [
      "a programmer", "a mathematician", "an AI", "a cat", "a chicken", "a philosopher",
      "a barista", "a robot vacuum", "a cloud", "a dad", "a vampire", "a ghost",
      "an optimist", "a pessimist", "a time traveler", "a quantum physicist"
    ];
    const ACTIONS = [
      "walks into a bar", "tries to debug", "orders coffee", "opens the fridge",
      "reads the manual", "compiles a poem", "asks for directions", "updates firmware",
      "joins a support group", "makes a backup", "catches a cold", "checks the weather"
    ];
    const SETTINGS = [
      "on a Tuesday", "during a code review", "in a blackout", "at 3 AM", "during rush hour",
      "at the lab", "at a coffee shop", "in the cloud", "on the moon", "in a dream"
    ];
    const TWISTS = [
      {type:"literal", text:"and the punchline was just a comment."},
      {type:"meta", text:"turns out it was a test of your patience."},
      {type:"wordplay", text:"because it couldn't find its pointer."},
      {type:"surprise", text:"and everyone clapped — for the Wi‑Fi."},
      {type:"absurd", text:"so it filed a bug report with the universe."},
      {type:"relatable", text:"because that's how Mondays feel."},
      {type:"pun", text:"it wanted to byte more than it could chew."},
      {type:"callback", text:"and that's when the toast became the butter."},
      {type:"nihil", text:"and then everything refreshed."},
      {type:"timing", text:"but the punchline arrived one commit too late."}
    ];

    // Joke templates: functions that accept components + params
    const TEMPLATES = [
      // setup + twist
      function(ctx){ return `${ctx.subject} ${ctx.action} ${ctx.setting}, ${ctx.twist}`; },
      // question style
      function(ctx){
        return `Why did ${ctx.subject} ${ctx.action.replace(/s$/,'') || ctx.action}? Because ${ctx.twist}`;
      },
      // short two-liner: setup then tag
      function(ctx){
        return `${ctx.subject} ${ctx.action}. ${ctx.twist}`;
      },
      // conditional logic: unexpected role reversal
      function(ctx){
        if (ctx.type === 'absurd' || ctx.silliness > 7) {
          return `Everyone expected ${ctx.subject} to ${ctx.action}, but it decided to ${pick(ctx.rng,["write poetry","start a band","become a salad"])} instead — ${ctx.twist}`;
        }
        return `${ctx.subject} ${ctx.action} ${ctx.setting}. ${ctx.twist}`;
      },
      // layered wordplay: build with two twists if silliness high
      function(ctx){
        const second = ctx.silliness > 6 ? ` Also, ${pick(ctx.rng, ["it couldn't commit to the relationship","its cache was full","it lost its keys"])}` : '';
        return `${ctx.subject} ${ctx.action} ${ctx.setting}. ${ctx.twist}${second}`;
      }
    ];

    // generator core
    function generate(seedText, silliness = 6, length = 3, explain=false){
      const rng = seededRng(seedText || String(Date.now()));
      const ctx = {
        rng,
        silliness,
        length,
        subject: pick(rng, SUBJECTS),
        action: pick(rng, ACTIONS),
        setting: pick(rng, SETTINGS),
      };

      // choose a twist that depends on silliness and subject
      let twistPool = TWISTS.slice();
      if (ctx.subject.includes("AI") || ctx.subject.includes("programmer") || ctx.subject.includes("robot")) {
        // favor tech twists
        twistPool = twistPool.filter(t => t.type !== 'nihil');
        twistPool.push({type:"tech", text:"because its cache needed clearing."});
      }
      if (silliness < 3) {
        // remove absurd options
        twistPool = twistPool.filter(t => t.type !== 'absurd' && t.type !== 'pun');
      }

      ctx.twist = pick(rng, twistPool).text;
      ctx.silliness = silliness;
      ctx.type = (TWISTS.find(t=>t.text===ctx.twist)||{}).type || 'mixed';

      // choose templates and combine with small logical constraints
      const used = new Set();
      let lines = [];
      for (let i=0;i<length;i++){
        // pick a template weighting toward simpler when length small or silliness low
        let pool = TEMPLATES.slice();
        if (length <= 2) pool = pool.filter((t,i)=>i<3);
        if (silliness <= 3) pool = pool.filter((t,i)=>i!==4); // avoid layered wordplay
        // avoid exact repeats
        let tpl;
        let attempts = 0;
        do {
          tpl = pick(rng, pool);
          attempts++;
        } while(used.has(tpl) && attempts < 8);
        used.add(tpl);
        lines.push(tpl(ctx));
      }

      const joke = lines.join(' ');
      const meta = {
        seed: seedText,
        subject: ctx.subject,
        action: ctx.action,
        setting: ctx.setting,
        twist: ctx.twist,
        type: ctx.type
      };

      if (explain) {
        const explanation = [
          `Chose subject "${meta.subject}" and action "${meta.action}".`,
          `Setting chosen: "${meta.setting}".`,
          `Twist type: ${meta.type} → "${meta.twist}".`,
          `Silliness: ${silliness}, Length: ${length}.`,
          `Template(s) used: ${[...used].length} template(s).`,
          `Randomness seeded by "${seedText}".`
        ].join(" ");
        return {joke, meta, explanation};
      }
      return {joke, meta};
    }

    // UI wiring
    const genBtn = document.getElementById('gen');
    const jokeEl = document.getElementById('joke');
    const sillEl = document.getElementById('sill');
    const lenEl = document.getElementById('length');
    const seedEl = document.getElementById('seed');
    const jtypeEl = document.getElementById('jtype');
    const jmoodEl = document.getElementById('jmood');
    const explainEl = document.getElementById('explain');
    const metaBtn = document.getElementById('metaBtn');

    function showGenerated(seed){
      const sill = parseInt(sillEl.value,10);
      const len = parseInt(lenEl.value,10);
      const seedText = seed || String(Math.floor(Math.random()*1e9));
      const out = generate(seedText, sill, len, true);
      jokeEl.textContent = out.joke;
      seedEl.textContent = out.meta.seed;
      jtypeEl.textContent = out.meta.type;
      jmoodEl.textContent = sill > 7 ? 'Silly' : (sill < 4 ? 'Dry' : 'Playful');
      explainEl.textContent = out.explanation;
      explainEl.style.display = 'none';
    }

    genBtn.addEventListener('click', ()=> showGenerated());
    metaBtn.addEventListener('click', ()=>{
      explainEl.style.display = explainEl.style.display === 'none' ? 'block' : 'none';
    });

    // seed by Enter key for reproducible jokes
    window.addEventListener('keydown', (e)=>{
      if ((e.key === 'Enter' || e.key === ' ') && (e.target === document.body || e.target === jokeEl)) {
        e.preventDefault();
        showGenerated();
      }
    });

    // generate one on load
    showGenerated(String(Math.floor(Math.random()*1e9)));
  </script>
</body>
</html>
