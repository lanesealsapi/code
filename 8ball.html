<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Magic Fortune Cookie</title>
<style>
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --accent:#ffd28a;
    --muted:#9aa6b2;
    --glass: rgba(255,255,255,0.06);
    --shadow: 0 8px 30px rgba(2,8,23,0.7);
    --ease:cubic-bezier(.2,.9,.3,1);
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg) 0%, #071226 100%);font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;}
  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:36px;}
  .card{
    width:360px;
    max-width:92vw;
    background:linear-gradient(180deg,var(--card), rgba(9,14,22,0.9));
    border-radius:18px;
    padding:28px;
    box-shadow:var(--shadow);
    color:#e6eef8;
    display:grid;gap:18px;place-items:center;
  }

  .title{font-size:18px;font-weight:600;letter-spacing:0.2px;color:var(--accent);display:flex;align-items:center;gap:10px;}
  .subtitle{font-size:13px;color:var(--muted);margin-top:-6px;text-align:center}

  .cookie-wrap{position:relative; width:220px; height:180px; display:flex;align-items:center;justify-content:center;}
  button.cookie{
    appearance:none;border:0;padding:0;background:transparent;cursor:pointer;border-radius:999px;
    width:220px;height:180px;display:flex;align-items:center;justify-content:center;position:relative;
    transition:transform 420ms var(--ease);
  }
  /* shake anim */
  .shaking{animation:shake 700ms both}
  @keyframes shake{
    10%{ transform: translateX(-8px) rotate(-6deg) }
    30%{ transform: translateX(6px) rotate(6deg) }
    50%{ transform: translateX(-4px) rotate(-3deg) }
    70%{ transform: translateX(3px) rotate(2deg) }
    100%{ transform: translateX(0) rotate(0) }
  }

  /* speech bubble */
  .bubble{
    position:absolute;
    bottom:100%;
    transform:translateY(-22px);
    min-width:220px;
    max-width:86vw;
    background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
    border-radius:12px;
    padding:14px 16px;
    box-shadow: 0 8px 32px rgba(2,8,23,0.55);
    color:#eaf3ff;
    font-size:14px;
    line-height:1.3;
    text-align:center;
    opacity:0;
    pointer-events:none;
    transform-origin:bottom center;
    transition:opacity 260ms var(--ease), transform 260ms var(--ease);
    border: 1px solid rgba(255,255,255,0.04);
  }
  .bubble.visible{opacity:1;transform:translateY(-12px) scale(1); pointer-events:auto;}

  .bubble::after{
    content:"";
    position:absolute;
    left:50%;
    transform:translateX(-50%);
    bottom:-8px;
    width:14px;height:14px;background:inherit;border-radius:3px;transform-origin:center;transform:rotate(45deg);
    filter:blur(0.2px);
    border-left:1px solid rgba(255,255,255,0.03);
    border-bottom:1px solid rgba(255,255,255,0.03);
  }

  /* small hint */
  .hint{font-size:12px;color:var(--muted);margin-top:6px}

  /* svg styling */
  svg.cookie-svg{width:180px;height:150px;display:block}
  .cookie-shell{fill:var(--accent);stroke:rgba(0,0,0,0.18);stroke-width:1.5}
  .cookie-top{fill:#fff3e6;opacity:0.06}
  .cookie-detail{fill:rgba(0,0,0,0.12)}
  .cookie-eye{fill:#081221}

  /* modern minimal footer row */
  .row{display:flex;gap:8px;align-items:center}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:10px;color:var(--muted);font-size:13px;cursor:pointer}
  .btn-ghost:active{transform:translateY(1px)}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" role="application" aria-label="Magic Fortune Cookie">
    <div style="display:flex;flex-direction:column;align-items:center;">
      <div class="title">Magic Fortune Cookie</div>
      <div class="subtitle">Click the cookie to get a fortune — modern & snappy.</div>
    </div>

    <div class="cookie-wrap" aria-hidden="false">
      <button id="cookieBtn" class="cookie" aria-label="Shake cookie to reveal fortune">
        <svg class="cookie-svg" viewBox="0 0 360 300" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <!-- stylized fortune-cookie shape -->
          <defs>
            <linearGradient id="g1" x1="0" x2="1" y1="0" y2="1">
              <stop offset="0" stop-color="#ffd98d"/>
              <stop offset="1" stop-color="#ffb86b"/>
            </linearGradient>
            <filter id="innerShadow" x="-20%" y="-20%" width="140%" height="140%">
              <feDropShadow dx="0" dy="6" stdDeviation="8" flood-color="#000" flood-opacity="0.25"/>
            </filter>
          </defs>

          <!-- back shell -->
          <path class="cookie-shell" d="M240 60c40 8 78 38 84 68 6 30-22 72-60 94-38 22-94 24-140 14-46-10-88-40-110-78-22-38-10-78 20-104 30-26 64-22 118-24 54-2 38-2 70 30z" fill="url(#g1)" filter="url(#innerShadow)"/>
          <!-- crease / mouth opening -->
          <path class="cookie-detail" d="M170 160c26-6 56-22 82-38" stroke="rgba(0,0,0,0.12)" stroke-width="6" fill="none" stroke-linecap="round"/>
          <!-- highlight -->
          <ellipse cx="220" cy="86" rx="36" ry="18" fill="rgba(255,255,255,0.18)"/>
          <!-- small embossed pattern -->
          <g opacity="0.12">
            <circle cx="260" cy="140" r="6" fill="#000"/>
            <circle cx="230" cy="112" r="4" fill="#000"/>
            <circle cx="200" cy="160" r="3" fill="#000"/>
          </g>

          <!-- little fortune paper peeking -->
          <rect id="note" x="120" y="125" width="90" height="36" rx="4" ry="4" fill="#fff9ef" transform="rotate(-18 165 143)" stroke="rgba(0,0,0,0.06)"/>
          <text id="noteText" x="135" y="148" font-family="Inter,Arial" font-size="12" fill="#0c1720" transform="rotate(-18 165 143)"></text>

        </svg>
      </button>

      <div id="bubble" class="bubble" role="status" aria-live="polite"></div>
    </div>

    <div class="row">
      <button id="newBtn" class="btn-ghost" aria-label="Another fortune">Another</button>
      <div style="flex:1"></div>
      <div class="hint">Tap/click the cookie</div>
    </div>
  </div>
</div>

<script>
(() => {
  // 10 fortune cookie readouts
  const FORTUNES = [
    "A welcome change is coming — stay ready.",
    "Trust a small voice inside: it knows the way.",
    "A delightful surprise arrives when you least expect it.",
    "Your kindness returns to you multiplied.",
    "New opportunities will ask for a brave yes.",
    "An old plan finds a fresh spark — revisit it.",
    "Joy grows when shared with someone new.",
    "A clear decision brings unexpected freedom.",
    "Luck favors the curious — explore a new path.",
    "Today’s small step becomes tomorrow’s victory."
  ];

  const cookieBtn = document.getElementById('cookieBtn');
  const bubble = document.getElementById('bubble');
  const newBtn = document.getElementById('newBtn');
  const noteText = document.getElementById('noteText');

  let lastIndex = -1;
  // pick non-repeating random
  function pickFortune(){
    if(FORTUNES.length === 1) return 0;
    let i;
    do { i = Math.floor(Math.random()*FORTUNES.length); } while(i === lastIndex);
    lastIndex = i;
    return i;
  }

  function showFortune(idx){
    const text = FORTUNES[idx];
    bubble.textContent = text;
    // also write small text on the little paper for visual feedback (truncated)
    const small = text.length > 28 ? text.slice(0,26) + "…" : text;
    noteText.textContent = small;
    bubble.classList.add('visible');
  }

  function hideFortune(){
    bubble.classList.remove('visible');
  }

  // Shake logic with snappy timing
  let busy = false;
  async function doShake(){
    if(busy) return;
    busy = true;
    hideFortune();
    // add CSS class to animate shake
    cookieBtn.classList.add('shaking');
    // short delay to sync reveal near end of shake
    await new Promise(r => setTimeout(r, 520));
    const idx = pickFortune();
    showFortune(idx);
    // finish shake
    await new Promise(r => setTimeout(r, 220));
    cookieBtn.classList.remove('shaking');
    busy = false;
  }

  cookieBtn.addEventListener('click', doShake);
  newBtn.addEventListener('click', doShake);

  // keyboard accessibility: Enter/Space on cookie
  cookieBtn.addEventListener('keydown', (e) => {
    if(e.key === "Enter" || e.code === "Space") { e.preventDefault(); doShake(); }
  });

  // initial fortune
  showFortune(pickFortune());
})();
</script>
